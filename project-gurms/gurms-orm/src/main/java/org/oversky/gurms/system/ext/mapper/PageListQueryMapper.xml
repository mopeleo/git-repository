<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.oversky.gurms.system.ext.dao.PageListQueryDao">

	<!-- ========================================================================================= -->
	<sql id="sysuser_column_list">
        <include refid="org.oversky.gurms.system.dao.SysUserDao.column_list"><property name="tab" value="a."/></include>
	</sql>
  
    <select id="findUsers" parameterType="org.oversky.gurms.system.entity.SysUser" resultMap="org.oversky.gurms.system.dao.SysUserDao.BaseResultMap">
        select <include refid="sysuser_column_list"/>
          from sys_user a
		<where>
			<if test="unioncode != null and unioncode != ''">
				and a.unioncode = #{unioncode}
			</if>
			<if test="status != null and status != ''">
				and a.status = #{status}
			</if>
			<if test="username != null and username != ''">
				<bind name="_username" value="'%' + username + '%'"/>
				and a.username like #{_username}
			</if>
			<if test="mobileno != null and mobileno != ''">
				and a.mobileno like CONCAT('%',#{mobileno},'%')
			</if>
		</where>
    </select>
  
	<!-- ========================================================================================= -->
	<sql id="sysrole_column_list">
        <include refid="org.oversky.gurms.system.dao.SysRoleDao.column_list"><property name="tab" value="a."/></include>
	</sql>
  
    <select id="findRoles" parameterType="org.oversky.gurms.system.entity.SysRole" resultMap="org.oversky.gurms.system.dao.SysRoleDao.BaseResultMap">
        select <include refid="sysrole_column_list"/>
          from sys_role a
		<where>
			<if test="unioncode != null and unioncode != ''">
				and a.unioncode = #{unioncode}
			</if>
			<if test="status != null and status != ''">
				and a.status = #{status}
			</if>
			<if test="rolename != null and rolename != ''">
				<bind name="_rolename" value="'%' + rolename + '%'"/>
				and a.rolename like #{_rolename}
			</if>
			<if test="true">
				and a.roletype = '0' or (a.roletype='1' and a.creator = #{creator})
			</if>
		</where>
    </select>
  
</mapper>